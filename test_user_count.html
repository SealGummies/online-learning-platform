<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test User Count</title>
</head>
<body>
    <h1>User Count Test</h1>
    <button id="testBtn">Test API Call</button>
    <div id="result"></div>

    <script>
        document.getElementById('testBtn').addEventListener('click', async () => {
            try {
                // First get an admin token
                const loginResponse = await fetch('http://localhost:3761/api/auth/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        email: 'admin1@test.com',
                        password: 'password123'
                    })
                });
                
                const loginData = await loginResponse.json();
                if (!loginData.success) {
                    throw new Error('Login failed');
                }
                
                const token = loginData.data.token;
                
                // Test default API call (paginated)
                const defaultResponse = await fetch('http://localhost:3761/api/users', {
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json',
                    },
                });
                
                const defaultData = await defaultResponse.json();
                
                // Test API call with high limit
                const allResponse = await fetch('http://localhost:3761/api/users?limit=1000', {
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json',
                    },
                });
                
                const allData = await allResponse.json();
                
                document.getElementById('result').innerHTML = `
                    <h3>API Test Results:</h3>
                    <p><strong>Default API call (paginated):</strong> ${defaultData.data.length} users returned</p>
                    <p><strong>Total in pagination:</strong> ${defaultData.pagination.total} users</p>
                    <p><strong>API call with limit=1000:</strong> ${allData.data.length} users returned</p>
                    <p><strong>Total in pagination (all):</strong> ${allData.pagination.total} users</p>
                    <hr>
                    <p><strong>Issue:</strong> Frontend was only getting ${defaultData.data.length} users instead of all ${allData.pagination.total} users.</p>
                    <p><strong>Fix:</strong> Modified frontend to use '?limit=1000' parameter to get all users.</p>
                `;
                
            } catch (error) {
                document.getElementById('result').innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
            }
        });
    </script>
</body>
</html>
